<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milch Experience - Mobile</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            background-color: black;
        }

        #playerContainer {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            width: 100%;
            height: 100%;
            position: relative;
        }

        .square {
            position: relative;
            background: url("https://i.postimg.cc/9MRsCJQ0/image.png") center center no-repeat;
            background-size: cover;
            transition: transform 0.3s ease, z-index 0.3s ease;
            overflow: hidden;
        }

        .square.tapped {
            transform: scale(1.04);
            z-index: 2;
        }

        .square.expanded {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            transform: none;
            z-index: 999;
        }

        .square.expanded~.square {
            z-index: 1;
        }

        .square video {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            object-fit: cover;
            display: none;
        }

        .square.expanded video {
            display: block;
        }

        #seekBar {
            display: none;
            width: 80%;
            margin: 0 auto;
            position: absolute;
            left: 10%;
            bottom: 10px;
        }

        .square.expanded.playing~#seekBar {
            display: block;
        }

        #controls {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            background: rgba(0, 0, 0, 0.6);
            padding: 10px;
            z-index: 3;
        }

        #seekBar::-webkit-slider-thumb {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div id="playerContainer">
        <div class="square" data-squareid="1">
            <video id="intro1"
                src="https://link.storjshare.io/s/jvsf3jhukg6dbgqlq5e6qauwchbq/music/video-output-55ABDD3F-533B-4378-ABFF-A76FA4631505.mp4?download=1"></video>
            <video id="loop1"
                src="https://link.storjshare.io/s/jvjwzyepdwe2xfuolfdq2kqdcp7a/music/milchloop.MP4?download=1" loop
                muted></video>
        </div>
        <div class="square" data-squareid="2">
            <video id="intro2"
                src="https://link.storjshare.io/s/jvsf3jhukg6dbgqlq5e6qauwchbq/music/video-output-55ABDD3F-533B-4378-ABFF-A76FA4631505.mp4?download=1"></video>
            <video id="loop2"
                src="https://link.storjshare.io/s/jvjwzyepdwe2xfuolfdq2kqdcp7a/music/milchloop.MP4?download=1" loop
                muted></video>
        </div>
        <div class="square" data-squareid="3">
            <video id="intro3"
                src="https://link.storjshare.io/s/jvsf3jhukg6dbgqlq5e6qauwchbq/music/video-output-55ABDD3F-533B-4378-ABFF-A76FA4631505.mp4?download=1"></video>
            <video id="loop3"
                src="https://link.storjshare.io/s/jvjwzyepdwe2xfuolfdq2kqdcp7a/music/milchloop.MP4?download=1" loop
                muted></video>
        </div>
        <div class="square" data-squareid="4">
            <video id="intro4"
                src="https://link.storjshare.io/s/jvsf3jhukg6dbgqlq5e6qauwchbq/music/video-output-55ABDD3F-533B-4378-ABFF-A76FA4631505.mp4?download=1"></video>
            <video id="loop4"
                src="https://link.storjshare.io/s/jvjwzyepdwe2xfuolfdq2kqdcp7a/music/milchloop.MP4?download=1" loop
                muted></video>
        </div>

        <div id="controls">
            <input id="seekBar" type="range" min="0" max="100" value="0">
        </div>

        <audio id="audio">
            <source src="https://link.storjshare.io/s/jvvuzllnvz7yqfsylqn5xeknupga/music/f.flac?download=1"
                type="audio/flac">
            Your browser does not support the audio tag.
        </audio>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const squares = document.querySelectorAll('.square');
            const audio = document.getElementById('audio');
            const seekBar = document.getElementById('seekBar');

            let currentSquare = null;
            let isIntroPlaying = false;

            function resetSquareVideos(sq) {
                const intro = sq.querySelector('video:first-of-type');
                const loop = sq.querySelector('video:last-of-type');
                intro.pause();
                intro.currentTime = 0;
                loop.pause();
                loop.currentTime = 0;
                sq.classList.remove('playing');
            }

            function playIntroThenLoop(sq) {
                const intro = sq.querySelector('video:first-of-type');
                const loop = sq.querySelector('video:last-of-type');

                isIntroPlaying = true;
                audio.play();
                intro.play();

                intro.onended = () => {
                    intro.style.opacity = '0';
                    loop.style.opacity = '1';
                    loop.play();
                    isIntroPlaying = false;
                };
            }

            function syncMedia() {
                const duration = audio.duration;
                if (!duration) return;
                const currentTime = audio.currentTime;
                seekBar.value = (currentTime / duration) * 100;
            }

            squares.forEach(sq => {
                sq.addEventListener('click', () => {
                    if (!sq.classList.contains('tapped') && !sq.classList.contains('expanded')) {
                        sq.classList.add('tapped');
                        return;
                    }
                    if (sq.classList.contains('tapped') && !sq.classList.contains('expanded')) {
                        squares.forEach(other => {
                            if (other !== sq) {
                                other.classList.remove('tapped', 'expanded', 'playing');
                                resetSquareVideos(other);
                            }
                        });
                        sq.classList.add('expanded');
                        currentSquare = sq;
                        sq.classList.add('playing');
                        playIntroThenLoop(sq);
                        return;
                    }
                    if (sq.classList.contains('expanded')) {
                        resetSquareVideos(sq);
                        audio.pause();
                        audio.currentTime = 0;
                        sq.classList.remove('expanded', 'tapped', 'playing');
                        currentSquare = null;
                    }
                });
            });

            seekBar.addEventListener('input', () => {
                const seekTime = (seekBar.value / 100) * audio.duration;
                audio.currentTime = seekTime;
                syncMedia();
            });

            audio.addEventListener('timeupdate', syncMedia);
        });
    </script>
</body>

</html>